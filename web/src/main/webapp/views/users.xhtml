<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <meta name="viewport" content="width=device-width, initial-scale=1" http-equiv="X-UA-Conpatible"/>
    <title>User accounts</title>
    <h:outputStylesheet name="webjars/bootstrap/5.1.3/css/bootstrap.css"/>
    <h:outputScript name="webjars/popper.js/2.9.3/cjs/popper.js"/>
    <h:outputScript name="webjars/bootstrap/5.1.3/js/bootstrap.js"/>
</h:head>

<h:body>
    <ui:include src="header.xhtml"/>
    <div class="album py-5 bg-white">
        <div class="container-fluid row">
            <div class="col-md-3">
                <ui:include src="userFilter.xhtml"/>
            </div>
            <div class="col-md-9">
                <h2>User accounts</h2>
                <h:form>
                    <h:commandLink value="Create user" styleClass="btn btn-success" action="newUser"/>
                </h:form>
                <br/>
                <div id="bonusCardContainer" class="row row-cols-1 row-cols-md-1">
                    <ui:repeat value="#{userController.users}" var="user">
                        <div class="col mb-4">
                            <div class="card shadow">
                                <div class="row no-gutters">
                                    <div class="col-md-3 my-5 ms-5">
                                        <img src="../images/person-circle.svg" width="200em"
                                             alt="account photo label"/>
                                    </div>
                                    <div class="col">
                                        <div class="card-body my-5">
                                            <h1 class="card-title">${user.firstName} ${user.lastName}</h1>
                                            <h2 class="card-title">ID: ${user.id}</h2>
                                            <h5 class="card-title">ZIP: ${user.zip}</h5>
                                            <h5 class="card-title">Email: ${user.email}</h5>
                                            <h5 class="card-title">
                                                Discount: ${user.discountCode.code} (${user.discountCode.discount}%)
                                            </h5>
                                            <div class="row">
                                                <div class="col">
                                                    <h:form>
                                                        <div class="d-grid">
                                                            <h:commandButton value="Update" action="updateUser"
                                                                             styleClass="btn btn-outline-primary">
                                                                <f:setPropertyActionListener
                                                                        target="#{userController.toUpdate}"
                                                                        value="#{user}"/>
                                                            </h:commandButton>
                                                        </div>
                                                    </h:form>
                                                </div>
                                                <div class="col">
                                                    <h:form>
                                                        <div class="d-grid">
                                                            <h:commandButton value="Delete"
                                                                             action="#{userController.delete}"
                                                                             styleClass="btn btn-outline-danger">
                                                                <f:setPropertyActionListener
                                                                        target="#{userController.deleteId}"
                                                                        value="#{user.id}"/>
                                                            </h:commandButton>
                                                        </div>
                                                    </h:form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ui:repeat>
                </div>
            </div>
        </div>
    </div>
    <ui:include src="footer.xhtml"/>
</h:body>

</html>